# Kickstart file automatically generated by anaconda.

install
cdrom
key --skip
lang en_US.UTF-8
keyboard us
xconfig --startxonboot --resolution 1024x768
network --device eth0 --bootproto dhcp --hostname localdev
# Repository Location
#url --url=http://mirror.centos.org/centos/5.7/os/x86_64
url --url=http://vault.centos.org/5.7/os/x86_64
repo --name=30and30 --baseurl=http://dev.30and30.com/CentOS/5.7/x86_64/repo
rootpw --iscrypted $1$ncgwUwPS$qT6bYLus9kTmC1wkJj82M.
firewall --disabled
authconfig --useshadow --enablemd5
selinux --disabled
timezone --utc America/New_York
bootloader --location=mbr --driveorder=sda --append="rhgb quiet"
# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work
clearpart --all --initlabel
part /boot --fstype ext3 --size=50
part / --fstype ext3 --size=10000 --grow --maxsize=20000
part swap --size=1008 --grow --maxsize=2016
part /home --fstype ext3 --size=10000 --grow
reboot

%packages
@base
@core
@X Window System
@GNOME Desktop Environment
@Graphical Internet
@Development Tools
python

#copy postinstall files to /root/postinstall in order 
#for them to be available in the following %post section
%post --nochroot
mkdir /tmp/c
mount -t iso9660 /tmp/cdrom /tmp/c
cp -r /tmp/c/ks/postinstall /mnt/sysimage/root
umount /tmp/c

%post
#!/bin/bash
(
#set debug mode for verbose logging
set -x

#switch to terminal 3
exec < /dev/tty3 > /dev/tty3
chvt 3

#network is configured above with dhcp, but /etc/resolv.conf is not yet created.
#start network explicity to work around it.
service network start
cat /etc/resolv.conf

cd /root

#execute postinstall script
./postinstall/postinstall.sh

#switch back to terminal 1
chvt 1
) 2>&1 | tee /root/post-install.log
